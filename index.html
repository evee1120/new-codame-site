<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Codame</title>
</head>

<body>
    <header>
        <nav>
            <div>
                <a href="index.html"><img src="assets/CODAME2012_Logo_01_opacity95.png" alt="Codame"></a>

            
            </div>
            <div class="topnav" id="myTopnav">
                <div class="dropdown">
                    <button class="dropbtn">Events
                        <i class="fa fa-caret-down"></i>
                    </button>
                    <div class="dropdown-content">
                        <a href="#">Festival</a>
                        <a href="#">Workshops</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn">Collective
                        <i class="fa fa-caret-down"></i>
                    </button>
                    <div class="dropdown-content">
                        <a href="#">Artists</a>
                        <a href="#">Sponsors</a>
                        <a href="#">Volunteer</a>
                    </div>
                </div>
                <a href="#">Projects</a>
                <a href="https://codame.substack.com/">Blog</a>
                <a href="#">About</a>
                <a href="#">Join Us</a>
                <a href="#">Support</a>
                <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="myFunction()">&#9776;</a>
            </div>
        </nav>
    </header>


    <main>
        <section class="hero" id="hero">
            <div class="hero-bg" id="hero-bg"></div>
            <div class="hero-content">
                <h1 id="hero-title">Loading...</h1>
                <p id="hero-description">Loading...</p>
                <a href="#" class="hero-button" id="hero-button">Loading...</a>
            </div>
        </section>

        <section class="cta">
            <div class="cta-content">
                <h2>Subscribe to stay updated with our ART+TECH newsletter!</h2>
                <form id="newsletter-form">
                    <input type="email" id="newsletter-email" placeholder="Your email address" required>
                    <button type="submit" id="newsletter-submit">Subscribe</button>
                </form>
            </div>
        </section>
    </main>
    <footer>
        <p>&copy; 2023 Codame</p>
    </footer>


    <script>
        function myFunction() {
            var x = document.getElementById("myTopnav");
            if (x.className === "topnav") {
                x.className += " responsive";
            } else {
                x.className = "topnav";
            }
        }
    </script>
    <script async>
        // Define an asynchronous function to fetch and update the hero content
        async function fetchHeroContent() {
            try {
                const response = await fetch('https://api-us.storyblok.com/v2/cdn/stories/landing?cv=1697159503&token=yPople2hy09krH7bbnQLPgtt', {
                    method: 'GET',
                    headers: {
                        'Authorization': 'v1fxbuwZXfPeZufShydBKgtt', // Replace with your actual API token
                    }
                });
                const data = await response.json();

                // Log the fetched data to the console for debugging
                console.log('Fetched Data:', data);

                const heroContent = data.story.content;

                if (heroContent) {
                    // Access title and description within the hero component
                    const heroComponent = heroContent.body.find(item => item.component === 'hero');
                    if (heroComponent) {
                        console.log('HeroComponent: ', heroComponent);
                        document.getElementById('hero-title').textContent = heroComponent.title;
                        document.getElementById('hero-description').innerHTML = heroComponent.description.content[0].content[0].text;

                        // Access the background image from the hero component

                        // Asset UUID and filename
                        //const assetUUID = heroComponent._uid;
                        //document.getElementById('hero-bg').style.backgroundImage = `https://img2.storyblok.com/${assetUUID}`;

                        //get hero cta
                        document.getElementById('hero-button').textContent = heroComponent.ctaText;
                        document.getElementById('hero-button').href = heroComponent.ctaLink.url; // Access the URL property within ctaLink
                    } else {
                        console.error('Hero component not found in the data structure.');
                    }
                } else {
                    console.error('Invalid data structure from Storyblok');
                }
            } catch (error) {
                console.error('API request error:', error);
            }
        }

        // Call the asynchronous function to fetch and update the hero content
        fetchHeroContent();
    </script>
</body>

</html>